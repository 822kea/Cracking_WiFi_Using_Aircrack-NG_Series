
# **Lab 2: Exploiting WPA/WPA2 Networks Using WPS**

In this lab, we’ll use the **Wi-Fi Protected Setup (WPS)** feature to exploit WPA/WPA2-protected networks.  

---
## **What is WPS?**
**WPS** allows clients to connect to a Wi-Fi network without entering a secure password by using either:

- A physical button on the router
- An 8-digit PIN

The 8-digit PIN can be brute-forced quickly, making it a vulnerability.

---

## **What is WPA/WPA2?**  
**Wi-Fi Protected Access (WPA)** and its improved version, **WPA2**, are security protocols designed to secure wireless networks.  

- **WPA**: Introduced in 2003 to replace the weaker WEP (Wired Equivalent Privacy). It uses TKIP (Temporal Key Integrity Protocol) for encryption.  
- **WPA2**: An enhanced version introduced in 2004. It replaced TKIP with the more secure AES (Advanced Encryption Standard) and introduced CCMP (Counter Mode Cipher Block Chaining Message Authentication Code Protocol) for data integrity.  

While WPA2 is significantly stronger than its predecessors, vulnerabilities such as WPS make it susceptible to attacks. This is why understanding and addressing these risks is essential for securing networks.

---

## **Steps to Exploit a WPS Network**

### **Step 1: Enable Monitor Mode**
Refer to **Lab 1** if you need detailed instructions for enabling monitor mode. In short:  
1. Disable your network interface.  
2. Stop interfering processes.  
3. Enable monitor mode.  

---

### **Step 2: Identify WPS-Enabled Networks**
Use the `wash` tool to scan for networks with WPS enabled.  

Run the following command:  
```bash
wash --interface <your_int_name>
```

#### **Understanding the Output**
Once the scan runs, you’ll see the following information:  
- **BSSID**: MAC address of the network  
- **Ch**: Channel number  
- **dBm**: Signal strength  
- **WPS**: WPS version used  
- **Lck**: Indicates if WPS is locked  
- **Vendor**: Manufacturer of the router  
- **ESSID**: Network name  

Stop the scan with `Ctrl + C`.  

---

### **Step 3: Choose a Target Network**
Select a WPS-enabled network from the list.  

If the target network isn’t generating enough data, you can run a **fake authentication attack** to force it to communicate more.  

---

### **Step 4: Perform a Fake Authentication Attack**  
Fake authentication tricks the access point (AP) into thinking your machine is a client. This forces the AP to generate additional data for analysis.  

Run the following command:  
```bash
aireplay-ng --fakeauth 30 -a <target_bssid> -h <your_bssid> <your_int_name>
```

#### **Explanation of Arguments**:
- `30`: Number of times to send fake authentication packets.  
- `-a <target_bssid>`: The MAC address of the target network.  
- `-h <your_bssid>`: The MAC address of your wireless adapter.  

To find **<your_bssid>**, use the `ifconfig` command. Replace `-` with `:` in your MAC address.

---

### **Step 5: Brute Force the WPS PIN**
Now, we’ll use `reaver` to brute-force the WPS PIN and retrieve the WPA/WPA2 passphrase.  

Run the following command in a **new terminal window**:  
```bash
reaver --bssid <target_bssid> --channel <ch_of_target> --interface <your_int_name> -vvv --no-associate
```

#### **Explanation of Arguments**:
- `-vvv`: Provides detailed output (e.g., errors or reasons for failures).  
- `--no-associate`: Prevents automatic association since we’re handling this with `aireplay-ng`.  

---

### **Step 6: Run Both Commands Together**
1. Start `reaver` in one terminal window.  
2. Immediately run `aireplay-ng` in the other terminal window.  

`Reaver` will try all possible PIN combinations. If the correct PIN is guessed, it will reveal the WPA/WPA2 Pre-Shared Key (PSK).  

---

## **Why This Matters**
An 8-digit WPS PIN can be cracked relatively easily, even by someone with limited technical knowledge. This demonstrates why disabling WPS and using secure methods to protect your network is critical.  

### **Pro Tip for Network Security**
- Disable WPS on your router if it’s not needed.  
- Use strong WPA3 encryption or a long, complex WPA2 passphrase.  

---  

## **Skills and Knowledge Gained**

- Understand the vulnerabilities of WPS-enabled networks and how they can compromise WPA/WPA2 security.
- Learn to identify WPS-enabled networks using tools like `wash`.
- Using advanced tools like `aireplay-ng` and `reaver` to exploit network weaknesses.
